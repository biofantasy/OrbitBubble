<Window x:Class="OrbitBubble.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:OrbitBubble.Core.ViewModels"
        xmlns:behaviors="clr-namespace:OrbitBubble.Core.Behaviors"
        Title="OrbitBubble"
        Width="900" Height="700"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="#111">

	<Grid>

		<!-- 泡泡 -->
		<ItemsControl ItemsSource="{Binding VisibleBubbles}">
			<ItemsControl.ItemsPanel>
				<ItemsPanelTemplate>
					<Canvas />
				</ItemsPanelTemplate>
			</ItemsControl.ItemsPanel>

			<ItemsControl.ItemContainerStyle>
				<Style TargetType="ContentPresenter">
					<Setter Property="Canvas.Left" Value="{Binding X}" />
					<Setter Property="Canvas.Top" Value="{Binding Y}" />
				</Style>
			</ItemsControl.ItemContainerStyle>

			<ItemsControl.ItemTemplate>
				<DataTemplate DataType="{x:Type vm:BubbleViewModel}">
					<Border behaviors:BubbleDragDrop.Enable="True"
                            MouseLeftButtonUp="Bubble_Click"
                            Width="80" Height="80" CornerRadius="40"
                            Background="#222" BorderBrush="#444" BorderThickness="1">
						<Grid>
							<Image Source="{Binding Icon}" Width="32" Height="32"
                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
							<TextBlock Text="{Binding DisplayName}"
                                       Margin="6,44,6,6"
                                       Foreground="White"
                                       FontSize="10"
                                       TextAlignment="Center"
                                       TextTrimming="CharacterEllipsis"/>
						</Grid>
					</Border>
				</DataTemplate>
			</ItemsControl.ItemTemplate>
		</ItemsControl>

		<!-- Debug：確認綁定是不是有資料（想移除就刪掉這塊） -->
		<TextBlock Text="{Binding VisibleBubbles.Count}"
                   Foreground="Lime"
                   FontSize="14"
                   HorizontalAlignment="Left"
                   VerticalAlignment="Top"
                   Margin="10"/>
	</Grid>
</Window>
